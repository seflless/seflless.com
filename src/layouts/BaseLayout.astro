---
import { ViewTransitions } from "astro:transitions";
import { ThemeToggle } from "@/components/ThemeToggle";
import "../styles/global.css";

interface Props {
  title: string;
  description?: string;
}

const { title, description = "Francois Laberge's personal blog" } = Astro.props;
const currentPath = Astro.url.pathname;

const navItems = [
  { href: "/", label: "Home" },
  { href: "/about", label: "About" },
  { href: "/blog", label: "Blog" },
  { href: "/projects", label: "Projects" },
  { href: "/resume", label: "Resume" },
];
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <title>{title}</title>
    <ViewTransitions />
    <script is:inline>
      // Prevent flash of wrong theme
      (function () {
        const theme = localStorage.getItem("theme");
        if (theme === "dark") {
          document.documentElement.classList.add("dark");
        }
      })();
    </script>
  </head>
  <body class="min-h-screen bg-background text-foreground">
    <div class="flex min-h-screen">
      <!-- Left Sidebar -->
      <aside
        class="fixed left-0 top-0 z-40 h-screen w-56 border-r border-border bg-sidebar"
      >
        <div class="flex h-full flex-col">
          <!-- Logo / Name -->
          <div class="flex h-14 items-center border-b border-sidebar-border px-4">
            <a href="/" class="font-semibold text-sidebar-foreground">
              Francois Laberge
            </a>
          </div>

          <!-- Navigation -->
          <nav class="flex-1 space-y-1 p-4">
            {
              navItems.map((item) => {
                const isActive =
                  currentPath === item.href ||
                  (item.href !== "/" && currentPath.startsWith(item.href));
                return (
                  <a
                    href={item.href}
                    class:list={[
                      "block rounded-md px-3 py-2 text-sm font-medium transition-colors",
                      isActive
                        ? "bg-sidebar-accent text-sidebar-accent-foreground"
                        : "text-sidebar-foreground hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",
                    ]}
                  >
                    {item.label}
                  </a>
                );
              })
            }
          </nav>

          <!-- Theme Toggle -->
          <div class="border-t border-sidebar-border p-4">
            <ThemeToggle client:load />
          </div>
        </div>
      </aside>

      <!-- Main Content -->
      <main class="ml-56 flex-1 p-8">
        <div class="mx-auto max-w-3xl">
          <slot />
        </div>
      </main>
    </div>
  </body>
</html>
